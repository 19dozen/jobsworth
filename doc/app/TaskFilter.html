<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: TaskFilter</title>

	<link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

	<script src="./js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="./app/models/task_filter_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="app/models/task_filter.rb">app/models/task_filter.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link"><a href="ActiveRecord/Base.html">ActiveRecord::Base</a></p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-c-system_filter">::system_filter</a></li>
					
					<li><a href="#method-i-cache_key">#cache_key</a></li>
					
					<li><a href="#method-i-column_name_for">#column_name_for</a></li>
					
					<li><a href="#method-i-compose_sql">#compose_sql</a></li>
					
					<li><a href="#method-i-conditions">#conditions</a></li>
					
					<li><a href="#method-i-conditions_for_customer_qualifiers">#conditions_for_customer_qualifiers</a></li>
					
					<li><a href="#method-i-conditions_for_keywords">#conditions_for_keywords</a></li>
					
					<li><a href="#method-i-conditions_for_property_qualifiers">#conditions_for_property_qualifiers</a></li>
					
					<li><a href="#method-i-conditions_for_standard_qualifiers">#conditions_for_standard_qualifiers</a></li>
					
					<li><a href="#method-i-conditions_for_status_qualifiers">#conditions_for_status_qualifiers</a></li>
					
					<li><a href="#method-i-conditions_for_time_qualifiers">#conditions_for_time_qualifiers</a></li>
					
					<li><a href="#method-i-copy_from">#copy_from</a></li>
					
					<li><a href="#method-i-count">#count</a></li>
					
					<li><a href="#method-i-display_count">#display_count</a></li>
					
					<li><a href="#method-i-generate_name">#generate_name</a></li>
					
					<li><a href="#method-i-keywords_attributes%3D">#keywords_attributes=</a></li>
					
					<li><a href="#method-i-parse_fullcalendar_params">#parse_fullcalendar_params</a></li>
					
					<li><a href="#method-i-parse_jqgrid_params">#parse_jqgrid_params</a></li>
					
					<li><a href="#method-i-set_company_from_user">#set_company_from_user</a></li>
					
					<li><a href="#method-i-simple_conditions_for_customer_qualifiers">#simple_conditions_for_customer_qualifiers</a></li>
					
					<li><a href="#method-i-simple_conditions_for_keywords">#simple_conditions_for_keywords</a></li>
					
					<li><a href="#method-i-simple_conditions_for_property_qualifiers">#simple_conditions_for_property_qualifiers</a></li>
					
					<li><a href="#method-i-simple_conditions_for_standard_qualifiers">#simple_conditions_for_standard_qualifiers</a></li>
					
					<li><a href="#method-i-simple_conditions_for_status_qualifiers">#simple_conditions_for_status_qualifiers</a></li>
					
					<li><a href="#method-i-simple_conditions_for_time_qualifiers">#simple_conditions_for_time_qualifiers</a></li>
					
					<li><a href="#method-i-store_for">#store_for</a></li>
					
					<li><a href="#method-i-tasks">#tasks</a></li>
					
					<li><a href="#method-i-tasks_all">#tasks_all</a></li>
					
					<li><a href="#method-i-tasks_for_fullcalendar">#tasks_for_fullcalendar</a></li>
					
					<li><a href="#method-i-tasks_for_gantt">#tasks_for_gantt</a></li>
					
					<li><a href="#method-i-tasks_for_jqgrid">#tasks_for_jqgrid</a></li>
					
					<li><a href="#method-i-to_include">#to_include</a></li>
					
					<li><a href="#method-i-unread_conditions">#unread_conditions</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="./LICENSE.html">LICENSE</a></li>
				
					<li class="file"><a href="./NOTICE.html">NOTICE</a></li>
				
					<li class="file"><a href="./README_rdoc.html">README.rdoc</a></li>
				
					<li class="file"><a href="./RELEASE-NOTES.html">RELEASE-NOTES</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="./images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="./ActionController.html">ActionController</a></li>
				
					<li><a href="./ActionController/Caching.html">ActionController::Caching</a></li>
				
					<li><a href="./ActionController/Caching/Fragments.html">ActionController::Caching::Fragments</a></li>
				
					<li><a href="./ActionView.html">ActionView</a></li>
				
					<li><a href="./ActionView/Helpers.html">ActionView::Helpers</a></li>
				
					<li><a href="./ActionView/Helpers/DateHelper.html">ActionView::Helpers::DateHelper</a></li>
				
					<li><a href="./ActiveSupport.html">ActiveSupport</a></li>
				
					<li><a href="./ActiveSupport/Cache.html">ActiveSupport::Cache</a></li>
				
					<li><a href="./ActiveSupport/Cache/FileStore.html">ActiveSupport::Cache::FileStore</a></li>
				
					<li><a href="./ActiveRecord.html">ActiveRecord</a></li>
				
					<li><a href="./ActiveRecord/Base.html">ActiveRecord::Base</a></li>
				
					<li><a href="./AbstractTask.html">AbstractTask</a></li>
				
					<li><a href="./AccessLevel.html">AccessLevel</a></li>
				
					<li><a href="./ActivitiesController.html">ActivitiesController</a></li>
				
					<li><a href="./ActivitiesHelper.html">ActivitiesHelper</a></li>
				
					<li><a href="./AdminController.html">AdminController</a></li>
				
					<li><a href="./AdminHelper.html">AdminHelper</a></li>
				
					<li><a href="./ApiController.html">ApiController</a></li>
				
					<li><a href="./ApiHelper.html">ApiHelper</a></li>
				
					<li><a href="./ApplicationController.html">ApplicationController</a></li>
				
					<li><a href="./ApplicationHelper.html">ApplicationHelper</a></li>
				
					<li><a href="./ClientsController.html">ClientsController</a></li>
				
					<li><a href="./ClientsHelper.html">ClientsHelper</a></li>
				
					<li><a href="./CompaniesController.html">CompaniesController</a></li>
				
					<li><a href="./CompaniesHelper.html">CompaniesHelper</a></li>
				
					<li><a href="./Company.html">Company</a></li>
				
					<li><a href="./CustomAttribute.html">CustomAttribute</a></li>
				
					<li><a href="./CustomAttributeChoice.html">CustomAttributeChoice</a></li>
				
					<li><a href="./CustomAttributeMethods.html">CustomAttributeMethods</a></li>
				
					<li><a href="./CustomAttributeValue.html">CustomAttributeValue</a></li>
				
					<li><a href="./CustomAttributesController.html">CustomAttributesController</a></li>
				
					<li><a href="./CustomAttributesHelper.html">CustomAttributesHelper</a></li>
				
					<li><a href="./Customer.html">Customer</a></li>
				
					<li><a href="./Date.html">Date</a></li>
				
					<li><a href="./DateAndTimeHelper.html">DateAndTimeHelper</a></li>
				
					<li><a href="./Email.html">Email</a></li>
				
					<li><a href="./EmailAddress.html">EmailAddress</a></li>
				
					<li><a href="./EventLog.html">EventLog</a></li>
				
					<li><a href="./FeedsController.html">FeedsController</a></li>
				
					<li><a href="./FeedsHelper.html">FeedsHelper</a></li>
				
					<li><a href="./Forum.html">Forum</a></li>
				
					<li><a href="./ForumsController.html">ForumsController</a></li>
				
					<li><a href="./ForumsHelper.html">ForumsHelper</a></li>
				
					<li><a href="./GeneratedReport.html">GeneratedReport</a></li>
				
					<li><a href="./IcalEntry.html">IcalEntry</a></li>
				
					<li><a href="./Keyword.html">Keyword</a></li>
				
					<li><a href="./Locale.html">Locale</a></li>
				
					<li><a href="./LocalesController.html">LocalesController</a></li>
				
					<li><a href="./LocalesHelper.html">LocalesHelper</a></li>
				
					<li><a href="./Localization.html">Localization</a></li>
				
					<li><a href="./LoginController.html">LoginController</a></li>
				
					<li><a href="./LoginHelper.html">LoginHelper</a></li>
				
					<li><a href="./Mailman.html">Mailman</a></li>
				
					<li><a href="./MigrationHelpers.html">MigrationHelpers</a></li>
				
					<li><a href="./Milestone.html">Milestone</a></li>
				
					<li><a href="./MilestonesController.html">MilestonesController</a></li>
				
					<li><a href="./MilestonesHelper.html">MilestonesHelper</a></li>
				
					<li><a href="./Misc.html">Misc</a></li>
				
					<li><a href="./ModeratorsController.html">ModeratorsController</a></li>
				
					<li><a href="./ModeratorsHelper.html">ModeratorsHelper</a></li>
				
					<li><a href="./Moderatorship.html">Moderatorship</a></li>
				
					<li><a href="./Monitorship.html">Monitorship</a></li>
				
					<li><a href="./MonitorshipsController.html">MonitorshipsController</a></li>
				
					<li><a href="./MonitorshipsHelper.html">MonitorshipsHelper</a></li>
				
					<li><a href="./NewsItem.html">NewsItem</a></li>
				
					<li><a href="./Notifications.html">Notifications</a></li>
				
					<li><a href="./NotificationsHelper.html">NotificationsHelper</a></li>
				
					<li><a href="./Object.html">Object</a></li>
				
					<li><a href="./ObjectFilter.html">ObjectFilter</a></li>
				
					<li><a href="./OrderedHash.html">OrderedHash</a></li>
				
					<li><a href="./OrganizationalUnit.html">OrganizationalUnit</a></li>
				
					<li><a href="./OrganizationalUnitHelper.html">OrganizationalUnitHelper</a></li>
				
					<li><a href="./OrganizationalUnitsController.html">OrganizationalUnitsController</a></li>
				
					<li><a href="./Page.html">Page</a></li>
				
					<li><a href="./PagesController.html">PagesController</a></li>
				
					<li><a href="./PagesHelper.html">PagesHelper</a></li>
				
					<li><a href="./Post.html">Post</a></li>
				
					<li><a href="./PostsController.html">PostsController</a></li>
				
					<li><a href="./PostsHelper.html">PostsHelper</a></li>
				
					<li><a href="./Preference.html">Preference</a></li>
				
					<li><a href="./PreferenceMethods.html">PreferenceMethods</a></li>
				
					<li><a href="./Project.html">Project</a></li>
				
					<li><a href="./ProjectFile.html">ProjectFile</a></li>
				
					<li><a href="./ProjectFilesController.html">ProjectFilesController</a></li>
				
					<li><a href="./ProjectFilesHelper.html">ProjectFilesHelper</a></li>
				
					<li><a href="./ProjectFolder.html">ProjectFolder</a></li>
				
					<li><a href="./ProjectPermission.html">ProjectPermission</a></li>
				
					<li><a href="./ProjectSweeper.html">ProjectSweeper</a></li>
				
					<li><a href="./ProjectsController.html">ProjectsController</a></li>
				
					<li><a href="./ProjectsHelper.html">ProjectsHelper</a></li>
				
					<li><a href="./PropertiesController.html">PropertiesController</a></li>
				
					<li><a href="./PropertiesHelper.html">PropertiesHelper</a></li>
				
					<li><a href="./Property.html">Property</a></li>
				
					<li><a href="./PropertyValue.html">PropertyValue</a></li>
				
					<li><a href="./ReportsController.html">ReportsController</a></li>
				
					<li><a href="./ReportsHelper.html">ReportsHelper</a></li>
				
					<li><a href="./Resource.html">Resource</a></li>
				
					<li><a href="./ResourceAttribute.html">ResourceAttribute</a></li>
				
					<li><a href="./ResourceType.html">ResourceType</a></li>
				
					<li><a href="./ResourceTypeAttribute.html">ResourceTypeAttribute</a></li>
				
					<li><a href="./ResourceTypesController.html">ResourceTypesController</a></li>
				
					<li><a href="./ResourceTypesHelper.html">ResourceTypesHelper</a></li>
				
					<li><a href="./ResourcesController.html">ResourcesController</a></li>
				
					<li><a href="./ResourcesHelper.html">ResourcesHelper</a></li>
				
					<li><a href="./ScheduleController.html">ScheduleController</a></li>
				
					<li><a href="./ScheduleHelper.html">ScheduleHelper</a></li>
				
					<li><a href="./ScmChangeset.html">ScmChangeset</a></li>
				
					<li><a href="./ScmChangesetsController.html">ScmChangesetsController</a></li>
				
					<li><a href="./ScmChangesetsHelper.html">ScmChangesetsHelper</a></li>
				
					<li><a href="./ScmFile.html">ScmFile</a></li>
				
					<li><a href="./ScmProject.html">ScmProject</a></li>
				
					<li><a href="./ScmProjectsController.html">ScmProjectsController</a></li>
				
					<li><a href="./ScmProjectsHelper.html">ScmProjectsHelper</a></li>
				
					<li><a href="./ScriptsController.html">ScriptsController</a></li>
				
					<li><a href="./Search.html">Search</a></li>
				
					<li><a href="./SearchController.html">SearchController</a></li>
				
					<li><a href="./Sheet.html">Sheet</a></li>
				
					<li><a href="./Signup.html">Signup</a></li>
				
					<li><a href="./Status.html">Status</a></li>
				
					<li><a href="./Tag.html">Tag</a></li>
				
					<li><a href="./TagSweeper.html">TagSweeper</a></li>
				
					<li><a href="./TagsController.html">TagsController</a></li>
				
					<li><a href="./TagsHelper.html">TagsHelper</a></li>
				
					<li><a href="./Task.html">Task</a></li>
				
					<li><a href="./TaskCustomer.html">TaskCustomer</a></li>
				
					<li><a href="./TaskFilter.html">TaskFilter</a></li>
				
					<li><a href="./TaskFilterHelper.html">TaskFilterHelper</a></li>
				
					<li><a href="./TaskFilterQualifier.html">TaskFilterQualifier</a></li>
				
					<li><a href="./TaskFiltersController.html">TaskFiltersController</a></li>
				
					<li><a href="./TaskOwner.html">TaskOwner</a></li>
				
					<li><a href="./TaskPropertyValue.html">TaskPropertyValue</a></li>
				
					<li><a href="./TaskTemplatesController.html">TaskTemplatesController</a></li>
				
					<li><a href="./TaskTemplatesHelper.html">TaskTemplatesHelper</a></li>
				
					<li><a href="./TaskUser.html">TaskUser</a></li>
				
					<li><a href="./TaskWatcher.html">TaskWatcher</a></li>
				
					<li><a href="./TasksController.html">TasksController</a></li>
				
					<li><a href="./TasksHelper.html">TasksHelper</a></li>
				
					<li><a href="./Template.html">Template</a></li>
				
					<li><a href="./Thumbnail.html">Thumbnail</a></li>
				
					<li><a href="./Time.html">Time</a></li>
				
					<li><a href="./TimeParser.html">TimeParser</a></li>
				
					<li><a href="./TimeRange.html">TimeRange</a></li>
				
					<li><a href="./TimeTrackingHelper.html">TimeTrackingHelper</a></li>
				
					<li><a href="./TimelineController.html">TimelineController</a></li>
				
					<li><a href="./TimelineHelper.html">TimelineHelper</a></li>
				
					<li><a href="./Todo.html">Todo</a></li>
				
					<li><a href="./TodosController.html">TodosController</a></li>
				
					<li><a href="./TodosHelper.html">TodosHelper</a></li>
				
					<li><a href="./Topic.html">Topic</a></li>
				
					<li><a href="./TopicsController.html">TopicsController</a></li>
				
					<li><a href="./TopicsHelper.html">TopicsHelper</a></li>
				
					<li><a href="./Trigger.html">Trigger</a></li>
				
					<li><a href="./TriggersController.html">TriggersController</a></li>
				
					<li><a href="./TriggersHelper.html">TriggersHelper</a></li>
				
					<li><a href="./User.html">User</a></li>
				
					<li><a href="./UsersController.html">UsersController</a></li>
				
					<li><a href="./UsersHelper.html">UsersHelper</a></li>
				
					<li><a href="./Widget.html">Widget</a></li>
				
					<li><a href="./WidgetsController.html">WidgetsController</a></li>
				
					<li><a href="./WidgetsHelper.html">WidgetsHelper</a></li>
				
					<li><a href="./WikiController.html">WikiController</a></li>
				
					<li><a href="./WikiHelper.html">WikiHelper</a></li>
				
					<li><a href="./WikiPage.html">WikiPage</a></li>
				
					<li><a href="./WikiReference.html">WikiReference</a></li>
				
					<li><a href="./WikiRevision.html">WikiRevision</a></li>
				
					<li><a href="./WorkController.html">WorkController</a></li>
				
					<li><a href="./WorkHelper.html">WorkHelper</a></li>
				
					<li><a href="./WorkLog.html">WorkLog</a></li>
				
					<li><a href="./WorkLogNotification.html">WorkLogNotification</a></li>
				
					<li><a href="./WorkLogsController.html">WorkLogsController</a></li>
				
					<li><a href="./WorkLogsHelper.html">WorkLogsHelper</a></li>
				
					<li><a href="./WorklogReport.html">WorklogReport</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">TaskFilter</h1>

		<div id="description">
			<pre>
 
</pre>
<p>
A task filter is used to find tasks matching the filters set up in session.
</p>
<pre>
 </pre>

		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		

		<!-- Methods -->
		
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="system-filter-method" class="method-detail ">
				<a name="method-c-system_filter"></a>

				<div class="method-heading">
				
					<span class="method-name">system_filter</span><span
						class="method-args">(user)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns the system filter for the given user. If none is found, create and
saves a new one and returns that.
</p>
					

					
					<div class="method-source-code"
						id="system-filter-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 23</span>
23:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">system_filter</span>(<span class="ruby-identifier">user</span>)
24:     <span class="ruby-identifier">filter</span> = <span class="ruby-identifier">user</span>.<span class="ruby-identifier">task_filters</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:system</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">first</span>
25:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">nil?</span>
26:       <span class="ruby-identifier">filter</span> = <span class="ruby-identifier">user</span>.<span class="ruby-identifier">task_filters</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;System filter for #{ user }&quot;</span>,
27:                                        <span class="ruby-value">:user_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">id</span>, <span class="ruby-value">:system</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
28:       <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">save!</span>
29:     <span class="ruby-keyword kw">end</span>
30: 
31:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">filter</span>
32:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="cache-key-method" class="method-detail ">
				<a name="method-i-cache_key"></a>

				<div class="method-heading">
				
					<span class="method-name">cache_key</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="cache-key-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 116</span>
116:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cache_key</span>
117:     <span class="ruby-identifier">key</span> = <span class="ruby-keyword kw">super</span>
118: 
119:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">unread_only?</span>
120:       <span class="ruby-comment cmt"># we can't cache the whole filter when unread_only set</span>
121:       <span class="ruby-node">&quot;#{ key }/Time.now.to_i/#{ user.id }/#{ rand }/&quot;</span>
122:     <span class="ruby-keyword kw">else</span>
123:       <span class="ruby-identifier">last_task_update</span> = <span class="ruby-identifier">user</span>.<span class="ruby-identifier">company</span>.<span class="ruby-identifier">tasks</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">conditions</span>).<span class="ruby-identifier">includes</span>(<span class="ruby-identifier">to_include</span>).<span class="ruby-identifier">maximum</span>(<span class="ruby-value">:updated_at</span>)
124:       <span class="ruby-node">&quot;#{ key }/#{ last_task_update.to_i }/#{ user.id }&quot;</span>
125:     <span class="ruby-keyword kw">end</span>
126:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="conditions-method" class="method-detail ">
				<a name="method-i-conditions"></a>

				<div class="method-heading">
				
					<span class="method-name">conditions</span><span
						class="method-args">(extra_conditions = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns an array of the conditions to use for a sql lookup of tasks for
this filter
</p>
					

					
					<div class="method-source-code"
						id="conditions-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 84</span>
 84:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">conditions</span>(<span class="ruby-identifier">extra_conditions</span> = <span class="ruby-keyword kw">nil</span>)
 85:     <span class="ruby-identifier">time_qualifiers</span> = <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;TimeRange&quot;</span> }
 86:     <span class="ruby-identifier">status_qualifiers</span> = <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;Status&quot;</span> }
 87:     <span class="ruby-identifier">property_qualifiers</span> = <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;PropertyValue&quot;</span> }
 88:     <span class="ruby-identifier">customer_qualifiers</span> = <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;Customer&quot;</span> }
 89:     <span class="ruby-identifier">standard_qualifiers</span> = (<span class="ruby-identifier">qualifiers</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">property_qualifiers</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">status_qualifiers</span> <span class="ruby-operator">-</span>
 90:                            <span class="ruby-identifier">customer_qualifiers</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">time_qualifiers</span>)
 91: 
 92:     <span class="ruby-identifier">res</span> = <span class="ruby-identifier">conditions_for_standard_qualifiers</span>(<span class="ruby-identifier">standard_qualifiers</span>)
 93:     <span class="ruby-identifier">res</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">conditions_for_property_qualifiers</span>(<span class="ruby-identifier">property_qualifiers</span>)
 94:     <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">conditions_for_status_qualifiers</span>(<span class="ruby-identifier">status_qualifiers</span>)
 95:     <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">conditions_for_customer_qualifiers</span>(<span class="ruby-identifier">customer_qualifiers</span>)
 96:     <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">conditions_for_time_qualifiers</span>(<span class="ruby-identifier">time_qualifiers</span>)
 97:     <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">conditions_for_keywords</span>
 98:     <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">extra_conditions</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">extra_conditions</span>
 99:     <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">unread_conditions</span>(<span class="ruby-identifier">user</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">unread_only?</span>
100: 
101:     <span class="ruby-identifier">res</span> = <span class="ruby-identifier">res</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">c</span>.<span class="ruby-identifier">blank?</span> }
102:     <span class="ruby-identifier">res</span> = <span class="ruby-identifier">res</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; AND &quot;</span>)
103: 
104:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">res</span>
105:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="copy-from-method" class="method-detail ">
				<a name="method-i-copy_from"></a>

				<div class="method-heading">
				
					<span class="method-name">copy_from</span><span
						class="method-args">(filter)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="copy-from-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 127</span>
127:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">copy_from</span>(<span class="ruby-identifier">filter</span>)
128:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unread_only</span> = <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">unread_only</span>
129:     <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">qualifiers</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">clone</span> }
130:     <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">keywords</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">kw</span><span class="ruby-operator">|</span>
131:       <span class="ruby-comment cmt"># N.B Shouldn't have to pass in all these values, but it</span>
132:       <span class="ruby-comment cmt"># doesn't work when we don't, so...</span>
133:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">keywords</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value">:task_filter</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>,
134:                              <span class="ruby-value">:company</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">company</span>,
135:                              <span class="ruby-value">:word</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">kw</span>.<span class="ruby-identifier">word</span>)
136:     <span class="ruby-keyword kw">end</span>
137:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="count-method" class="method-detail ">
				<a name="method-i-count"></a>

				<div class="method-heading">
				
					<span class="method-name">count</span><span
						class="method-args">(extra_conditions = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns the count of tasks matching the conditions of this filter. if
extra_conditions is passed, that will be ANDed to the conditions
</p>
					

					
					<div class="method-source-code"
						id="count-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 69</span>
69:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">count</span>(<span class="ruby-identifier">extra_conditions</span> = <span class="ruby-keyword kw">nil</span>)
70:     <span class="ruby-constant">Task</span>.<span class="ruby-identifier">all_accessed_by</span>(<span class="ruby-identifier">user</span>).<span class="ruby-identifier">where</span>(<span class="ruby-identifier">conditions</span>(<span class="ruby-identifier">extra_conditions</span>)).<span class="ruby-identifier">includes</span>(<span class="ruby-identifier">to_include</span>).<span class="ruby-identifier">count</span>
71:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="display-count-method" class="method-detail ">
				<a name="method-i-display_count"></a>

				<div class="method-heading">
				
					<span class="method-name">display_count</span><span
						class="method-args">(user, force_recount = false)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a count to display for this filter. The count represents the number
of tasks that look they need attention for the given user - unassigned
tasks and unread tasks are counted. The value will be cached and re-used
unless force_recount is passed.
</p>
					

					
					<div class="method-source-code"
						id="display-count-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 77</span>
77:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">display_count</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">force_recount</span> = <span class="ruby-keyword kw">false</span>)
78:     <span class="ruby-ivar">@display_count</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">force_recount</span>
79:     <span class="ruby-ivar">@display_count</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">count</span>(<span class="ruby-identifier">unread_conditions</span>(<span class="ruby-identifier">user</span>, <span class="ruby-keyword kw">true</span>))
80:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="keywords-attributes--method" class="method-detail ">
				<a name="method-i-keywords_attributes%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">keywords_attributes=</span><span
						class="method-args">(new_keywords)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the keywords for this filter using the given array
</p>
					

					
					<div class="method-source-code"
						id="keywords-attributes--source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 108</span>
108:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">keywords_attributes=</span>(<span class="ruby-identifier">new_keywords</span>)
109:     <span class="ruby-identifier">keywords</span>.<span class="ruby-identifier">clear</span>
110: 
111:     (<span class="ruby-identifier">new_keywords</span> <span class="ruby-operator">||</span> []).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">kw</span><span class="ruby-operator">|</span>
112:       <span class="ruby-identifier">keywords</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">kw</span>)
113:     <span class="ruby-keyword kw">end</span>
114:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="store-for-method" class="method-detail ">
				<a name="method-i-store_for"></a>

				<div class="method-heading">
				
					<span class="method-name">store_for</span><span
						class="method-args">(user)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="store-for-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 139</span>
139:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">store_for</span>(<span class="ruby-identifier">user</span>)
140:     <span class="ruby-keyword kw">if</span> (<span class="ruby-constant">TaskFilter</span>.<span class="ruby-identifier">recent_for</span>(<span class="ruby-identifier">user</span>).<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">10</span>)
141:       <span class="ruby-constant">TaskFilter</span>.<span class="ruby-identifier">recent_for</span>(<span class="ruby-identifier">user</span>).<span class="ruby-identifier">last</span>.<span class="ruby-identifier">destroy</span>
142:     <span class="ruby-keyword kw">end</span>
143:     <span class="ruby-identifier">filter</span>=<span class="ruby-constant">TaskFilter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:recent_for_user_id=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">user</span>.<span class="ruby-identifier">id</span>, <span class="ruby-value">:user=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">user</span>, <span class="ruby-value">:company=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">company</span>)
144:     <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">name</span>= <span class="ruby-identifier">generate_name</span>
145:     <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">name</span>= <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">name</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">blank?</span>
146:     <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">copy_from</span>(<span class="ruby-keyword kw">self</span>)
147:     <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">save!</span>
148:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="tasks-method" class="method-detail ">
				<a name="method-i-tasks"></a>

				<div class="method-heading">
				
					<span class="method-name">tasks</span><span
						class="method-args">(extra_conditions = nil, limit_tasks = true)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns an array of all tasks matching the conditions from this filter. If
extra_conditions is passed, that will be ANDed to the conditions If limit
is false, no limit will be set on the tasks returned (otherwise a default
limit will be applied)
</p>
					

					
					<div class="method-source-code"
						id="tasks-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 38</span>
38:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tasks</span>(<span class="ruby-identifier">extra_conditions</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">limit_tasks</span> = <span class="ruby-keyword kw">true</span>)
39:     <span class="ruby-identifier">limit</span> = (<span class="ruby-identifier">limit_tasks</span> <span class="ruby-operator">?</span> <span class="ruby-value">500</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>)
40:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Task</span>.<span class="ruby-identifier">all_accessed_by</span>(<span class="ruby-identifier">user</span>).<span class="ruby-identifier">where</span>(<span class="ruby-identifier">conditions</span>(<span class="ruby-identifier">extra_conditions</span>)).<span class="ruby-identifier">includes</span>(<span class="ruby-identifier">to_include</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-identifier">limit</span>)
41:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="tasks-all-method" class="method-detail ">
				<a name="method-i-tasks_all"></a>

				<div class="method-heading">
				
					<span class="method-name">tasks_all</span><span
						class="method-args">(parameters={ })</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns an array of all tasks matching the conditions from this filter. If
:conditions is passed, that will be ANDed to the conditions if :include is
passed, that will be ANDed to the <a
href="TaskFilter.html#method-i-to_include">to_include</a> also support
:order, :limit
</p>
					

					
					<div class="method-source-code"
						id="tasks-all-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 61</span>
61:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tasks_all</span>(<span class="ruby-identifier">parameters</span>={ })
62:     <span class="ruby-identifier">parameters</span>[<span class="ruby-value">:conditions</span>]=<span class="ruby-identifier">conditions</span>(<span class="ruby-identifier">parameters</span>[<span class="ruby-value">:conditions</span>])
63:     <span class="ruby-identifier">parameters</span>[<span class="ruby-value">:include</span>]= <span class="ruby-identifier">to_include</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">parameters</span>[<span class="ruby-value">:include</span>]<span class="ruby-operator">||</span>[])
64:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Task</span>.<span class="ruby-identifier">all_accessed_by</span>(<span class="ruby-identifier">user</span>).<span class="ruby-identifier">where</span>(<span class="ruby-identifier">parameters</span>[<span class="ruby-value">:conditions</span>]).<span class="ruby-identifier">includes</span>(<span class="ruby-identifier">parameters</span>[<span class="ruby-value">:include</span>]).<span class="ruby-identifier">order</span>(<span class="ruby-identifier">parameters</span>[<span class="ruby-value">:order</span>]).<span class="ruby-identifier">limit</span>(<span class="ruby-identifier">parameters</span>[<span class="ruby-value">:limit</span>]).<span class="ruby-identifier">offset</span>(<span class="ruby-identifier">parameters</span>[<span class="ruby-value">:offset</span>])
65:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="tasks-for-fullcalendar-method" class="method-detail ">
				<a name="method-i-tasks_for_fullcalendar"></a>

				<div class="method-heading">
				
					<span class="method-name">tasks_for_fullcalendar</span><span
						class="method-args">(parameters)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns an array of all tasks matching the conditions from this filter.
</p>
					

					
					<div class="method-source-code"
						id="tasks-for-fullcalendar-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 49</span>
49:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tasks_for_fullcalendar</span>(<span class="ruby-identifier">parameters</span>)
50:     <span class="ruby-identifier">tasks</span>(<span class="ruby-identifier">parse_fullcalendar_params</span>(<span class="ruby-identifier">parameters</span>))
51:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="tasks-for-gantt-method" class="method-detail ">
				<a name="method-i-tasks_for_gantt"></a>

				<div class="method-heading">
				
					<span class="method-name">tasks_for_gantt</span><span
						class="method-args">(parameters)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="tasks-for-gantt-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 53</span>
53:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tasks_for_gantt</span>(<span class="ruby-identifier">parameters</span>)
54:     <span class="ruby-identifier">tasks_all</span>(<span class="ruby-value">:conditions=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">parse_fullcalendar_params</span>(<span class="ruby-identifier">parameters</span>), <span class="ruby-value">:include=</span><span class="ruby-operator">&gt;</span>[<span class="ruby-value">:milestone</span>], <span class="ruby-value">:order=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;projects.name, milestones.name&quot;</span>, <span class="ruby-value">:limit=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">500</span>)
55:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="tasks-for-jqgrid-method" class="method-detail ">
				<a name="method-i-tasks_for_jqgrid"></a>

				<div class="method-heading">
				
					<span class="method-name">tasks_for_jqgrid</span><span
						class="method-args">(parameters)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns an array of all tasks matching the conditions from this filter.
</p>
					

					
					<div class="method-source-code"
						id="tasks-for-jqgrid-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 44</span>
44:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tasks_for_jqgrid</span>(<span class="ruby-identifier">parameters</span>)
45:     <span class="ruby-identifier">tasks_all</span>(<span class="ruby-identifier">parse_jqgrid_params</span>(<span class="ruby-identifier">parameters</span>))
46:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="private-instance-method-details" class="method-section section">
			<h3 class="section-header">Private Instance Methods</h3>

		
			<div id="column-name-for-method" class="method-detail ">
				<a name="method-i-column_name_for"></a>

				<div class="method-heading">
				
					<span class="method-name">column_name_for</span><span
						class="method-args">(class_type)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns the column name to use for lookup for the given class_type
</p>
					

					
					<div class="method-source-code"
						id="column-name-for-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 344</span>
344:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">column_name_for</span>(<span class="ruby-identifier">class_type</span>)
345:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">class_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;User&quot;</span>
346:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;task_users.type= 'TaskOwner' AND task_users.user_id&quot;</span>
347:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">class_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;Project&quot;</span>
348:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;tasks.project_id&quot;</span>
349:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">class_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;Task&quot;</span>
350:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;tasks.id&quot;</span>
351:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">class_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;Customer&quot;</span>
352:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;projects.customer_id&quot;</span>
353:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">class_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;Company&quot;</span>
354:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;tasks.company_id&quot;</span>
355:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">class_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;Milestone&quot;</span>
356:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;tasks.milestone_id&quot;</span>
357:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">class_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;Tag&quot;</span>
358:       <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;task_tags.tag_id&quot;</span>
359:     <span class="ruby-keyword kw">else</span>
360:       <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{ class_type.downcase }_id&quot;</span>
361:     <span class="ruby-keyword kw">end</span>
362:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="compose-sql-method" class="method-detail ">
				<a name="method-i-compose_sql"></a>

				<div class="method-heading">
				
					<span class="method-name">compose_sql</span><span
						class="method-args">(arg1, arg2)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="compose-sql-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 375</span>
375:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">compose_sql</span>(<span class="ruby-identifier">arg1</span>, <span class="ruby-identifier">arg2</span>)
376:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg1</span>.<span class="ruby-identifier">blank?</span>
377:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg2</span>.<span class="ruby-identifier">blank?</span>
378:         <span class="ruby-value str">&quot;&quot;</span>
379:       <span class="ruby-keyword kw">else</span>
380:         <span class="ruby-node">&quot;( not #{arg2} )&quot;</span>
381:       <span class="ruby-keyword kw">end</span>
382:     <span class="ruby-keyword kw">else</span>
383:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg2</span>.<span class="ruby-identifier">blank?</span>
384:         <span class="ruby-identifier">arg1</span>
385:       <span class="ruby-keyword kw">else</span>
386:         <span class="ruby-node">&quot;(#{arg1} and not #{arg2})&quot;</span>
387:       <span class="ruby-keyword kw">end</span>
388:     <span class="ruby-keyword kw">end</span>
389:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="conditions-for-customer-qualifiers-method" class="method-detail ">
				<a name="method-i-conditions_for_customer_qualifiers"></a>

				<div class="method-heading">
				
					<span class="method-name">conditions_for_customer_qualifiers</span><span
						class="method-args">(customer_qualifiers)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a sql string fragment that will limit tasks to only those in a
project belonging to customers, or linked directly to the customer
</p>
					

					
					<div class="method-source-code"
						id="conditions-for-customer-qualifiers-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 299</span>
299:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">conditions_for_customer_qualifiers</span>(<span class="ruby-identifier">customer_qualifiers</span>)
300:     <span class="ruby-identifier">customer_qualifiers</span> = <span class="ruby-identifier">customer_qualifiers</span>.<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">qualifier</span><span class="ruby-operator">|</span> <span class="ruby-identifier">qualifier</span>.<span class="ruby-identifier">reversed?</span> }
301:     <span class="ruby-identifier">compose_sql</span>(<span class="ruby-identifier">simple_conditions_for_customer_qualifiers</span>(<span class="ruby-identifier">customer_qualifiers</span>[<span class="ruby-keyword kw">false</span>]), <span class="ruby-identifier">simple_conditions_for_customer_qualifiers</span>(<span class="ruby-identifier">customer_qualifiers</span>[<span class="ruby-keyword kw">true</span>]))
302:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="conditions-for-keywords-method" class="method-detail ">
				<a name="method-i-conditions_for_keywords"></a>

				<div class="method-heading">
				
					<span class="method-name">conditions_for_keywords</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a string sql fragment that will limit tasks to those that match the
set keywords
</p>
					

					
					<div class="method-source-code"
						id="conditions-for-keywords-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 250</span>
250:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">conditions_for_keywords</span>
251:     <span class="ruby-identifier">kws</span> = <span class="ruby-identifier">keywords</span>.<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">keyword</span><span class="ruby-operator">|</span> <span class="ruby-identifier">keyword</span>.<span class="ruby-identifier">reversed?</span> }
252:     <span class="ruby-identifier">compose_sql</span>(<span class="ruby-identifier">simple_conditions_for_keywords</span>(<span class="ruby-identifier">kws</span>[<span class="ruby-keyword kw">false</span>]), <span class="ruby-identifier">simple_conditions_for_keywords</span>(<span class="ruby-identifier">kws</span>[<span class="ruby-keyword kw">true</span>]))
253:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="conditions-for-property-qualifiers-method" class="method-detail ">
				<a name="method-i-conditions_for_property_qualifiers"></a>

				<div class="method-heading">
				
					<span class="method-name">conditions_for_property_qualifiers</span><span
						class="method-args">(property_qualifiers)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a conditions hash the will filter tasks based on the given property
value qualifiers
</p>
					

					
					<div class="method-source-code"
						id="conditions-for-property-qualifiers-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 205</span>
205:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">conditions_for_property_qualifiers</span>(<span class="ruby-identifier">property_qualifiers</span>)
206:     <span class="ruby-identifier">property_qualifiers</span> = <span class="ruby-identifier">property_qualifiers</span>.<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">qualifier</span><span class="ruby-operator">|</span> <span class="ruby-identifier">qualifier</span>.<span class="ruby-identifier">reversed?</span> }
207:     <span class="ruby-identifier">simple_conditions_for_property_qualifiers</span>(<span class="ruby-identifier">property_qualifiers</span>[<span class="ruby-keyword kw">false</span>]) <span class="ruby-operator">+</span> <span class="ruby-identifier">simple_conditions_for_property_qualifiers</span>(<span class="ruby-identifier">property_qualifiers</span>[<span class="ruby-keyword kw">true</span>]).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">sql</span><span class="ruby-operator">|</span> <span class="ruby-value str">&quot;not &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">sql</span> }
208:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="conditions-for-standard-qualifiers-method" class="method-detail ">
				<a name="method-i-conditions_for_standard_qualifiers"></a>

				<div class="method-heading">
				
					<span class="method-name">conditions_for_standard_qualifiers</span><span
						class="method-args">(standard_qualifiers)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns an array of conditions that will filter tasks based on the given
standard qualifiers. Standard qualifiers are things like project,
milestone, user, where a filter will OR the different users, but and
between different types
</p>
					

					
					<div class="method-source-code"
						id="conditions-for-standard-qualifiers-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 229</span>
229:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">conditions_for_standard_qualifiers</span>(<span class="ruby-identifier">standard_qualifiers</span>)
230:     <span class="ruby-identifier">standard_qualifiers</span> = <span class="ruby-identifier">standard_qualifiers</span>.<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">qualifier</span><span class="ruby-operator">|</span> <span class="ruby-identifier">qualifier</span>.<span class="ruby-identifier">reversed?</span>}
231:     <span class="ruby-identifier">simple_conditions_for_standard_qualifiers</span>(<span class="ruby-identifier">standard_qualifiers</span>[<span class="ruby-keyword kw">false</span>])<span class="ruby-operator">+</span> <span class="ruby-identifier">simple_conditions_for_standard_qualifiers</span>(<span class="ruby-identifier">standard_qualifiers</span>[<span class="ruby-keyword kw">true</span>]).<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">sql</span><span class="ruby-operator">|</span> <span class="ruby-value str">'not '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">sql</span>}
232:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="conditions-for-status-qualifiers-method" class="method-detail ">
				<a name="method-i-conditions_for_status_qualifiers"></a>

				<div class="method-heading">
				
					<span class="method-name">conditions_for_status_qualifiers</span><span
						class="method-args">(status_qualifiers)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a sql string fragment that will limit tasks to only status set by
the status qualifiers. <a href="Status.html">Status</a> qualifiers have to
be handled especially until the migration from an array in code to db
backed statuses is complete
</p>
					

					
					<div class="method-source-code"
						id="conditions-for-status-qualifiers-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 276</span>
276:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">conditions_for_status_qualifiers</span>(<span class="ruby-identifier">status_qualifiers</span>)
277:     <span class="ruby-identifier">status_qualifiers</span> = <span class="ruby-identifier">status_qualifiers</span>.<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">qualifier</span><span class="ruby-operator">|</span> <span class="ruby-identifier">qualifier</span>.<span class="ruby-identifier">reversed?</span> }
278:     <span class="ruby-identifier">compose_sql</span>(<span class="ruby-identifier">simple_conditions_for_status_qualifiers</span>(<span class="ruby-identifier">status_qualifiers</span>[<span class="ruby-keyword kw">false</span>]), <span class="ruby-identifier">simple_conditions_for_status_qualifiers</span>(<span class="ruby-identifier">status_qualifiers</span>[<span class="ruby-keyword kw">true</span>]))
279:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="conditions-for-time-qualifiers-method" class="method-detail ">
				<a name="method-i-conditions_for_time_qualifiers"></a>

				<div class="method-heading">
				
					<span class="method-name">conditions_for_time_qualifiers</span><span
						class="method-args">(time_qualifiers)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a sql string fragment that will limit tasks to only those which
match the given time qualifiers
</p>
					

					
					<div class="method-source-code"
						id="conditions-for-time-qualifiers-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 318</span>
318:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">conditions_for_time_qualifiers</span>(<span class="ruby-identifier">time_qualifiers</span>)
319:     <span class="ruby-identifier">time_qualifiers</span> = <span class="ruby-identifier">time_qualifiers</span>.<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">qualifier</span><span class="ruby-operator">|</span> <span class="ruby-identifier">qualifier</span>.<span class="ruby-identifier">reversed?</span> }
320:     <span class="ruby-identifier">compose_sql</span>(<span class="ruby-identifier">simple_conditions_for_time_qualifiers</span>(<span class="ruby-identifier">time_qualifiers</span>[<span class="ruby-keyword kw">false</span>]), <span class="ruby-identifier">simple_conditions_for_time_qualifiers</span>(<span class="ruby-identifier">time_qualifiers</span>[<span class="ruby-keyword kw">true</span>]))
321:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="generate-name-method" class="method-detail ">
				<a name="method-i-generate_name"></a>

				<div class="method-heading">
				
					<span class="method-name">generate_name</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<pre>
 
</pre>
<p>
This method generate filter name based on qualifiers and keywords this name
will include first project, milestone, status, client, user qualifier in
this order then all keywords, then other qualifiers also name include only
3 items. Method is too complex, would be happy if we can remove order and
just cat first 3 items
</p>
<pre>
 </pre>
					

					
					<div class="method-source-code"
						id="generate-name-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 157</span>
157:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate_name</span>
158:     <span class="ruby-identifier">counter</span> = <span class="ruby-value">0</span>
159:     <span class="ruby-identifier">arr</span>=[]
160:     <span class="ruby-identifier">types</span>=[<span class="ruby-value str">&quot;Project&quot;</span>, <span class="ruby-value str">&quot;Milestone&quot;</span>, <span class="ruby-value str">&quot;Status&quot;</span>, <span class="ruby-value str">&quot;Client&quot;</span>, <span class="ruby-value str">&quot;User&quot;</span>]
161:     <span class="ruby-identifier">types</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">type</span><span class="ruby-operator">|</span>
162:       <span class="ruby-identifier">qualifier</span> = <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">detect</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable_type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">type</span> }
163:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">qualifier</span>.<span class="ruby-identifier">nil?</span>
164:         <span class="ruby-identifier">counter</span> <span class="ruby-operator">+=</span><span class="ruby-value">1</span>
165:         <span class="ruby-identifier">arr</span><span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">qualifier</span>.<span class="ruby-identifier">reversed?</span> <span class="ruby-operator">?</span> <span class="ruby-value str">'not '</span> <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">qualifier</span>.<span class="ruby-identifier">qualifiable</span>.<span class="ruby-identifier">to_s</span>
166:       <span class="ruby-keyword kw">end</span>
167:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">counter</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>
168:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)
169:       <span class="ruby-keyword kw">end</span>
170:     <span class="ruby-keyword kw">end</span>
171:     <span class="ruby-identifier">keywords</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">kw</span><span class="ruby-operator">|</span>
172:       <span class="ruby-identifier">counter</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
173:       <span class="ruby-identifier">arr</span><span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">kw</span>.<span class="ruby-identifier">reversed?</span> <span class="ruby-operator">?</span> <span class="ruby-value str">'not '</span> <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">kw</span>.<span class="ruby-identifier">word</span>;
174:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">counter</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>
175:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)
176:       <span class="ruby-keyword kw">end</span>
177:     <span class="ruby-keyword kw">end</span>
178:     <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">types</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable_type</span>)}.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">qualifier</span><span class="ruby-operator">|</span>
179:       <span class="ruby-identifier">counter</span> <span class="ruby-operator">+=</span><span class="ruby-value">1</span>
180:       <span class="ruby-identifier">arr</span><span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">qualifier</span>.<span class="ruby-identifier">reversed?</span> <span class="ruby-operator">?</span> <span class="ruby-value str">'not '</span> <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">qualifier</span>.<span class="ruby-identifier">qualifiable</span>.<span class="ruby-identifier">to_s</span>
181:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">counter</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>
182:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)
183:       <span class="ruby-keyword kw">end</span>
184:     <span class="ruby-keyword kw">end</span>
185:     <span class="ruby-identifier">arr</span><span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;Unread only&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">unread_only?</span>
186:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)
187:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="parse-fullcalendar-params-method" class="method-detail ">
				<a name="method-i-parse_fullcalendar_params"></a>

				<div class="method-heading">
				
					<span class="method-name">parse_fullcalendar_params</span><span
						class="method-args">(calendar_params)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This function parse fullCalendar `start` and `end` date(in Unix format)
from  params return conditions for <a
href="TaskFilter.html#method-i-tasks">TaskFilter#tasks</a>, unfortunately
TaskFilter#task does not support active record :conditions, only plain
sql:(
</p>
					

					
					<div class="method-source-code"
						id="parse-fullcalendar-params-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 447</span>
447:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_fullcalendar_params</span>(<span class="ruby-identifier">calendar_params</span>)
448:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">calendar_params</span>[<span class="ruby-value">:end</span>].<span class="ruby-identifier">blank?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">calendar_params</span>[<span class="ruby-value">:start</span>].<span class="ruby-identifier">blank?</span>
449:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">TaskFilter</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:sanitize_sql_array</span>, [<span class="ruby-value str">&quot;due_at &lt; ? and due_at &gt; ?&quot;</span>, <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-identifier">calendar_params</span>[<span class="ruby-value">:end</span>].<span class="ruby-identifier">to_i</span>), <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-identifier">calendar_params</span>[<span class="ruby-value">:start</span>].<span class="ruby-identifier">to_i</span>)])
450:     <span class="ruby-keyword kw">else</span>
451:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
452:     <span class="ruby-keyword kw">end</span>
453:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="parse-jqgrid-params-method" class="method-detail ">
				<a name="method-i-parse_jqgrid_params"></a>

				<div class="method-heading">
				
					<span class="method-name">parse_jqgrid_params</span><span
						class="method-args">(jqgrid_params)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Parse parameters from jqGrid for Task.all method This function used to sort
jqGrid created from tasks/list.xml.erb many columns in jqGrid calculated in
<a href="Task.html">Task</a> model or in tasks/list.xml.erb following sort
code duplicate logic from <a href="Task.html">Task</a>  and list.xml.erb in
sql `order by` TODO: Store all logic in sql view or create client side
sorting.
</p>
					

					
					<div class="method-source-code"
						id="parse-jqgrid-params-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 396</span>
396:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_jqgrid_params</span>(<span class="ruby-identifier">jqgrid_params</span>)
397:     <span class="ruby-identifier">tasks_params</span>={ }
398:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">jqgrid_params</span>[<span class="ruby-value">:rows</span>].<span class="ruby-identifier">blank?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">jqgrid_params</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">blank?</span>
399:       <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:limit</span>]=<span class="ruby-identifier">jqgrid_params</span>[<span class="ruby-value">:rows</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">jqgrid_params</span>[<span class="ruby-value">:rows</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
400:       <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:offset</span>]=<span class="ruby-identifier">jqgrid_params</span>[<span class="ruby-value">:page</span>].<span class="ruby-identifier">to_i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
401:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:offset</span>] <span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>
402:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:offset</span>] <span class="ruby-operator">*=</span> <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:limit</span>]
403:       <span class="ruby-keyword kw">else</span>
404:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:offset</span>]=<span class="ruby-keyword kw">nil</span>
405:       <span class="ruby-keyword kw">end</span>
406:     <span class="ruby-keyword kw">end</span>
407:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">jqgrid_params</span>[<span class="ruby-value">:sidx</span>]
408:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'summary'</span>
409:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>]=<span class="ruby-value str">'tasks.name'</span>
410:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'id'</span>
411:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>]=<span class="ruby-value str">'tasks.id'</span>
412:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'due'</span>
413:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:include</span>]=[<span class="ruby-value">:milestone</span>]
414:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>]=<span class="ruby-value str">'(case isnull(tasks.due_at)  when 1 then milestones.due_at when 0  then tasks.due_at end)'</span>
415:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'assigned'</span>
416:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>]=<span class="ruby-value str">'(select  group_concat(distinct users.name)  from  task_users  left outer join users on users.id = task_users.user_id where task_users.task_id=tasks.id  group by tasks.id)'</span>
417:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'milestone'</span>
418:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>]=<span class="ruby-value str">&quot;(select  CONCAT(projects.name, '/', if(isnull(milestones.name), '', milestones.name)) from tasks as ts inner join  projects on ts.project_id = projects.id left join milestones on ts.milestone_id = milestones.id where ts.id = tasks.id)&quot;</span>
419:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'client'</span>
420:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>]=<span class="ruby-value str">'if( exists(select  customers.name as client   from task_customers left outer join customers on task_customers.customer_id=customers.id where task_customers.task_id=tasks.id limit 1), (select  customers.name as client  from task_customers left outer join customers on task_customers.customer_id=customers.id where task_customers.task_id=tasks.id limit 1), (select customers.name from projects left outer join customers on projects.customer_id= customers.id where projects.id=tasks.project_id limit 1))'</span>
421:       <span class="ruby-keyword kw">else</span>
422:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">company</span>.<span class="ruby-identifier">properties</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">downcase</span> }.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">jqgrid_params</span>[<span class="ruby-value">:sidx</span>])
423:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">company</span>.<span class="ruby-identifier">properties</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span><span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
424:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">jqgrid_params</span>[<span class="ruby-value">:sidx</span>]
425:             <span class="ruby-ivar">@property_id</span> = <span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>
426:             <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>]= <span class="ruby-node">&quot;(select property_values.position from  task_property_values, property_values where tasks.id=task_property_values.task_id and task_property_values.property_id=#{@property_id} and task_property_values.property_value_id = property_values.id)&quot;</span>
427:           <span class="ruby-keyword kw">end</span>
428:         <span class="ruby-keyword kw">end</span>
429:       <span class="ruby-keyword kw">else</span>
430:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>]=<span class="ruby-keyword kw">nil</span>
431:       <span class="ruby-keyword kw">end</span>
432:     <span class="ruby-keyword kw">end</span>
433: 
434:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>].<span class="ruby-identifier">nil?</span>
435:       <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">jqgrid_params</span>[<span class="ruby-value">:sord</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'desc'</span>)
436:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>]<span class="ruby-operator">+=</span> <span class="ruby-value str">' desc'</span>
437:       <span class="ruby-keyword kw">end</span>
438:       <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">jqgrid_params</span>[<span class="ruby-value">:sord</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'asc'</span>)
439:         <span class="ruby-comment cmt">#make sort null to bottom</span>
440:         <span class="ruby-identifier">tasks_params</span>[<span class="ruby-value">:order</span>] = <span class="ruby-node">&quot;#{tasks_params[:order]} is null, #{tasks_params[:order]}&quot;</span>
441:       <span class="ruby-keyword kw">end</span>
442:     <span class="ruby-keyword kw">end</span>
443:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">tasks_params</span>
444:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-company-from-user-method" class="method-detail ">
				<a name="method-i-set_company_from_user"></a>

				<div class="method-heading">
				
					<span class="method-name">set_company_from_user</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="set-company-from-user-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 199</span>
199:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_company_from_user</span>
200:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">company</span> = <span class="ruby-identifier">user</span>.<span class="ruby-identifier">company</span>
201:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="simple-conditions-for-customer-qualifiers-method" class="method-detail ">
				<a name="method-i-simple_conditions_for_customer_qualifiers"></a>

				<div class="method-heading">
				
					<span class="method-name">simple_conditions_for_customer_qualifiers</span><span
						class="method-args">(customer_qualifiers)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="simple-conditions-for-customer-qualifiers-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 304</span>
304:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">simple_conditions_for_customer_qualifiers</span>(<span class="ruby-identifier">customer_qualifiers</span>)
305:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">customer_qualifiers</span>.<span class="ruby-identifier">nil?</span>
306:     <span class="ruby-identifier">ids</span> = <span class="ruby-identifier">customer_qualifiers</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable</span>.<span class="ruby-identifier">id</span> }
307:     <span class="ruby-identifier">ids</span> = <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;,&quot;</span>)
308: 
309:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">ids</span>.<span class="ruby-identifier">blank?</span>
310:       <span class="ruby-identifier">res</span> = <span class="ruby-node">&quot;projects.customer_id in (#{ ids })&quot;</span>
311:       <span class="ruby-identifier">res</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot; or coalesce(task_customers.customer_id in (#{ ids }),0)&quot;</span>
312:       <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;(#{ res })&quot;</span>
313:     <span class="ruby-keyword kw">end</span>
314:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="simple-conditions-for-keywords-method" class="method-detail ">
				<a name="method-i-simple_conditions_for_keywords"></a>

				<div class="method-heading">
				
					<span class="method-name">simple_conditions_for_keywords</span><span
						class="method-args">(keywords_arg)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="simple-conditions-for-keywords-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 255</span>
255:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">simple_conditions_for_keywords</span>(<span class="ruby-identifier">keywords_arg</span>)
256:     <span class="ruby-keyword kw">return</span>  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">keywords_arg</span>.<span class="ruby-identifier">nil?</span>
257:     <span class="ruby-identifier">sql</span> = []
258:     <span class="ruby-identifier">params</span> = []
259: 
260:     <span class="ruby-identifier">keywords_arg</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">kw</span><span class="ruby-operator">|</span>
261:       <span class="ruby-identifier">str</span> = <span class="ruby-value str">&quot;lower(tasks.name) like ?&quot;</span>
262:       <span class="ruby-identifier">str</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot; or lower(tasks.description) like ?&quot;</span>
263:       <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;coalesce((#{str}),0)&quot;</span>
264:       <span class="ruby-value">2</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">params</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;%#{ kw.word.downcase }%&quot;</span> }
265:     <span class="ruby-keyword kw">end</span>
266: 
267:     <span class="ruby-identifier">sql</span> = <span class="ruby-identifier">sql</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; or &quot;</span>)
268:     <span class="ruby-identifier">res</span> = <span class="ruby-constant">TaskFilter</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:sanitize_sql_array</span>, [ <span class="ruby-identifier">sql</span> ] <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>)
269:     <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;(#{ res })&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">res</span>.<span class="ruby-identifier">blank?</span>
270:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="simple-conditions-for-property-qualifiers-method" class="method-detail ">
				<a name="method-i-simple_conditions_for_property_qualifiers"></a>

				<div class="method-heading">
				
					<span class="method-name">simple_conditions_for_property_qualifiers</span><span
						class="method-args">(property_qualifiers)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="simple-conditions-for-property-qualifiers-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 210</span>
210:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">simple_conditions_for_property_qualifiers</span>(<span class="ruby-identifier">property_qualifiers</span>)
211:     <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">property_qualifiers</span>.<span class="ruby-identifier">nil?</span>
212:     <span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;task_property_values.property_value_id&quot;</span>
213:     <span class="ruby-identifier">grouped</span> = <span class="ruby-identifier">property_qualifiers</span>.<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable</span>.<span class="ruby-identifier">property</span> }
214: 
215:     <span class="ruby-identifier">res</span> = []
216:     <span class="ruby-identifier">grouped</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">property</span>, <span class="ruby-identifier">qualifiers</span><span class="ruby-operator">|</span>
217:       <span class="ruby-identifier">ids</span> = <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable</span>.<span class="ruby-identifier">id</span> }
218:       <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{ name } IN (#{ ids.join(&quot;, &quot;) })&quot;</span>
219:     <span class="ruby-keyword kw">end</span>
220: 
221:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">res</span>
222:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="simple-conditions-for-standard-qualifiers-method" class="method-detail ">
				<a name="method-i-simple_conditions_for_standard_qualifiers"></a>

				<div class="method-heading">
				
					<span class="method-name">simple_conditions_for_standard_qualifiers</span><span
						class="method-args">(standard_qualifiers)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="simple-conditions-for-standard-qualifiers-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 234</span>
234:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">simple_conditions_for_standard_qualifiers</span>(<span class="ruby-identifier">standard_qualifiers</span>)
235:     <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">standard_qualifiers</span>.<span class="ruby-identifier">nil?</span>
236:     <span class="ruby-identifier">res</span> = []
237: 
238:     <span class="ruby-identifier">grouped_conditions</span> = <span class="ruby-identifier">standard_qualifiers</span>.<span class="ruby-identifier">group_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable_type</span> }
239:     <span class="ruby-identifier">grouped_conditions</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span><span class="ruby-operator">|</span>
240:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">column_name_for</span>(<span class="ruby-identifier">type</span>)
241:       <span class="ruby-identifier">ids</span> = <span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">qualifiable_id</span> }
242:       <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{ name } in (#{ ids.join(&quot;,&quot;) })&quot;</span>
243:     <span class="ruby-keyword kw">end</span>
244: 
245:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">res</span>
246:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="simple-conditions-for-status-qualifiers-method" class="method-detail ">
				<a name="method-i-simple_conditions_for_status_qualifiers"></a>

				<div class="method-heading">
				
					<span class="method-name">simple_conditions_for_status_qualifiers</span><span
						class="method-args">(status_qualifiers)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="simple-conditions-for-status-qualifiers-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 281</span>
281:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">simple_conditions_for_status_qualifiers</span>(<span class="ruby-identifier">status_qualifiers</span>)
282:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">status_qualifiers</span>.<span class="ruby-identifier">nil?</span>
283:     <span class="ruby-identifier">old_status_ids</span> = []
284:     <span class="ruby-identifier">c</span> = <span class="ruby-identifier">company</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">company</span>
285: 
286:     <span class="ruby-identifier">status_qualifiers</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span>
287:       <span class="ruby-identifier">status</span> = <span class="ruby-identifier">q</span>.<span class="ruby-identifier">qualifiable</span>
288:       <span class="ruby-identifier">old_status</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">statuses</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">status</span>)
289:       <span class="ruby-identifier">old_status_ids</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">old_status</span>
290:     <span class="ruby-keyword kw">end</span>
291: 
292:     <span class="ruby-identifier">old_status_ids</span> = <span class="ruby-identifier">old_status_ids</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;,&quot;</span>)
293:     <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;tasks.status in (#{ old_status_ids })&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">old_status_ids</span>.<span class="ruby-identifier">blank?</span>
294:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="simple-conditions-for-time-qualifiers-method" class="method-detail ">
				<a name="method-i-simple_conditions_for_time_qualifiers"></a>

				<div class="method-heading">
				
					<span class="method-name">simple_conditions_for_time_qualifiers</span><span
						class="method-args">(time_qualifiers)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="simple-conditions-for-time-qualifiers-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 323</span>
323:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">simple_conditions_for_time_qualifiers</span>(<span class="ruby-identifier">time_qualifiers</span>)
324:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">time_qualifiers</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">time_qualifiers</span>.<span class="ruby-identifier">empty?</span>
325: 
326:     <span class="ruby-identifier">res</span> = []
327:     <span class="ruby-identifier">time_qualifiers</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tq</span><span class="ruby-operator">|</span>
328:       <span class="ruby-identifier">start_time</span> = <span class="ruby-identifier">tq</span>.<span class="ruby-identifier">qualifiable</span>.<span class="ruby-identifier">start_time</span>
329:       <span class="ruby-identifier">end_time</span> = <span class="ruby-identifier">tq</span>.<span class="ruby-identifier">qualifiable</span>.<span class="ruby-identifier">end_time</span>
330:       <span class="ruby-identifier">column</span> = <span class="ruby-identifier">tq</span>.<span class="ruby-identifier">qualifiable_column</span>
331:       <span class="ruby-identifier">column</span> = <span class="ruby-constant">Task</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">quote_column_name</span>(<span class="ruby-identifier">column</span>)
332: 
333:       <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;tasks.#{ column } &gt;= '#{ start_time.to_formatted_s(:db) }'&quot;</span>
334:       <span class="ruby-identifier">sql</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot; and tasks.#{ column } &lt; '#{ end_time.to_formatted_s(:db) }'&quot;</span>
335:       <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;coalesce((#{sql}),0)&quot;</span>
336:     <span class="ruby-keyword kw">end</span>
337: 
338:     <span class="ruby-identifier">res</span> = <span class="ruby-identifier">res</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; or &quot;</span>)
339:     <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;(#{ res })&quot;</span>
340:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="to-include-method" class="method-detail ">
				<a name="method-i-to_include"></a>

				<div class="method-heading">
				
					<span class="method-name">to_include</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="to-include-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 189</span>
189:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_include</span>
190:     <span class="ruby-identifier">to_include</span> = [ <span class="ruby-value">:project</span>, <span class="ruby-value">:task_users</span>]
191: 
192:     <span class="ruby-identifier">to_include</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:tags</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">for</span>(<span class="ruby-value str">&quot;Tag&quot;</span>).<span class="ruby-identifier">any?</span>
193:     <span class="ruby-identifier">to_include</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:task_property_values</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">for</span>(<span class="ruby-value str">&quot;PropertyValue&quot;</span>).<span class="ruby-identifier">any?</span>
194:     <span class="ruby-identifier">to_include</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:customers</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">qualifiers</span>.<span class="ruby-identifier">for</span>(<span class="ruby-value str">&quot;Customer&quot;</span>).<span class="ruby-identifier">any?</span>
195: 
196:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">to_include</span>
197:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="unread-conditions-method" class="method-detail ">
				<a name="method-i-unread_conditions"></a>

				<div class="method-heading">
				
					<span class="method-name">unread_conditions</span><span
						class="method-args">(user, include_orphaned = false)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="unread-conditions-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/task_filter.rb, line 364</span>
364:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unread_conditions</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">include_orphaned</span> = <span class="ruby-keyword kw">false</span>)
365:     <span class="ruby-identifier">count_conditions</span> = []
366:     <span class="ruby-identifier">count_conditions</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;(task_users.unread = ? and task_users.user_id = #{ user.id })&quot;</span>
367:     <span class="ruby-identifier">count_conditions</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;(task_users.id is null)&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">include_orphaned</span>
368:     <span class="ruby-identifier">sql</span> = <span class="ruby-identifier">count_conditions</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; or &quot;</span>)
369: 
370:     <span class="ruby-identifier">params</span> = [ <span class="ruby-keyword kw">true</span>]
371:     <span class="ruby-identifier">sql</span> = <span class="ruby-constant">TaskFilter</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:sanitize_sql_array</span>, [ <span class="ruby-identifier">sql</span> ] <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>)
372:     <span class="ruby-node">&quot;(#{ sql })&quot;</span>
373:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

